---
title: "Nullability: 이미지 리소스로 인한 서비스 장애 발생 건"
date: "240806"
tags: ["Issue"]
---

## 문제

퇴근 무렵, 서비스 메인 페이지에 장애가 발생했습니다.

## 원인

모든 API 응답은 정상이었지만, 프론트에서 리소스에 접근하지 못하고 있었습니다.

데이터 문제임을 직감하고 관련된 데이터 중 깨진 것을 찾고 있는데, 프론트 개발자 분께서 이미지 URL이 NULL이라고 알려주셨습니다.

## 해결

관련 데이터를 찾아 지우니 정상화 되었습니다. 30분간 서비스는 에러타임을 겪었습니다.

운영자들은 어드민을 통해 이미지를 업로드 하는데, 과정에서 실수가 있거나 에러가 발생한듯 싶었습니다.

API에서 모든 이미지 URL이 NULL인 경우에 대한 처리를 추가해서 방어코드를 작성하려는데, 매니저는 컬럼에 NOT NULL 제약을 걸수는 없는지를 물었습니다.

그렇게 처리하면 배포할 필요없이 바로 적용할 수 있겠다는 생각이 들었습니다.

어드민에서 별도의 처리를 하지 않아도 잘못된 데이터가 들어가는걸 방지할 수 있습니다.

## 배운 점

Nullability를 잘 다루는 것이 중요하다는 것을 새삼 느꼈습니다.

Nullable 필드에 대한 처리는 자칫 간과하기 쉽습니다. 프론트 개발자분들과 한번 더 논의해서 명확히 해두는 것이 좋습니다.

기획단에서도 이런 부분을 미리 고려해 주시겠다고 해서 감사했습니다.

또한 테이블에 컨스트레인트를 거는게 몇 줄의 방어코드를 작성하는 것보다 이슈 대응에 효율적이라는 것도 배웠습니다.
