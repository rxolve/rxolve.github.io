---
title: "DB에서 bigint 데이터를 가져올 때 뒷자리가 잘리는 현상"
date: "250218"
tags: ["RDS", "JavaScript", "Issue"]
---

#### 문제

데이터베이스에서 bigint 타입의 데이터를 가져올 때, 자바스크립트에서 뒷자리가 잘리는 현상이 발생할 수 있습니다.

#### 원인

데이터베이스의 bigint 타입이 64비트 정수를 저장하는 반면,

자바스크립트의 Number 타입은 IEEE 754 64비트 부동소수점 방식으로 동작하여 정수 부분에 대해 최대 53비트의 정밀도만 보장하기 때문에 발생합니다.

예를 들어, 데이터베이스에 저장된 bigint 값이 2⁵³(9,007,199,254,740,992) 이상의 정밀도를 가진다면,

이를 자바스크립트 Number로 변환할 때 안전한 정수 범위를 벗어나게 되어 뒷자리 숫자가 잘리거나 반올림되는 현상이 나타납니다.

이는 자바스크립트에서의 Number 타입이 정밀도 한계로 인해 발생하는 문제이며,

많은 DB 드라이버(예, MySQL, PostgreSQL 드라이버)에서 bigint를 자동으로 Number로 변환하는 경우에 이런 문제가 자주 보고됩니다.

#### 해결

- 문자열로 가져오기

  DB 드라이버나 ORM에서 bigint 컬럼을 문자열(String) 형태로 반환하도록 설정합니다.

  예를 들어, MySQL의 경우 connection 설정에 `bigNumberStrings: true` 옵션을 주면 bigint 데이터를 문자열로 받아 처리할 수 있습니다.

- BigInt 사용

  ES2020에서 도입된 BigInt 타입을 사용하면, 임의의 크기의 정수를 정확하게 다룰 수 있습니다.

  문자열로 받아온 값을 `BigInt(값)` 또는 리터럴 표기법(예: `12345678901234567890n`)으로 변환하여 사용할 수 있습니다.
