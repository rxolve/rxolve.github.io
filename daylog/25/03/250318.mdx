---
title: "쿠버네티스 ConfigMap과 Secret"
date: "250318"
tags: ["Kubernetes"]
---

쿠버네티스에서는 애플리케이션의 설정 정보를 파드 내부에 하드코딩하지 않고, 외부에서 주입할 수 있도록 설계되어 있습니다.

- ConfigMap: 애플리케이션 설정 데이터(예: 환경변수, 설정 파일)를 관리합니다.
- Secret: 민감한 정보(예: 비밀번호, API 키, 토큰)를 안전하게 관리하는 데 사용됩니다.

두 리소스 모두 애플리케이션과 설정 정보를 분리함으로써 애플리케이션의 이식성과 보안성을 높여줍니다.

## ConfigMap

#### 특징

- 설정 데이터 관리: 환경설정, 설정 파일, 명령줄 인자 등 비민감한 데이터를 저장합니다.
- 사용 방식: 파드의 환경변수, 명령줄 인자, 혹은 볼륨 마운트 형태로 주입할 수 있습니다.
- 유연성: 단일 키-값 형태 또는 전체 파일 단위로 구성할 수 있어, 애플리케이션의 설정을 손쉽게 관리할 수 있습니다.

#### 사용 예시 (YAML)

```yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: my-config
data:
  APP_MODE: "production"
  LOG_LEVEL: "debug"
```

이와 같이 정의한 ConfigMap은 파드에서 환경변수로 주입하거나, 설정 파일로 마운트할 수 있습니다.

## Secret

#### 주요 특징

- 민감 데이터 저장: 비밀번호, 토큰, 인증서 등 암호화된 정보나 민감한 데이터를 저장합니다.
- 보안 처리: 기본적으로 base64 인코딩되어 저장되지만, 이는 암호화가 아닌 단순 인코딩이므로, 클러스터 내에서의 접근 제어 및 추가 암호화(예: etcd 암호화)를 고려해야 합니다.
- 사용 방식: 환경변수, 파일 볼륨 마운트 등으로 파드에 주입할 수 있습니다.

#### 사용 예시 (YAML)

```yaml
apiVersion: v1
kind: Secret
metadata:
  name: my-secret
type: Opaque
data:
  password: cGFzc3dvcmQ= # "password"를 base64 인코딩한 값
```

이 Secret은 파드에서 환경변수로 주입하거나, 파일로 마운트하여 사용할 수 있습니다.

## ConfigMap vs. Secret

| 항목        | ConfigMap                                 | Secret                              |
| ----------- | ----------------------------------------- | ----------------------------------- |
| 용도        | 비민감 데이터 저장                        | 민감 데이터 저장                    |
| 데이터 처리 | 평문 그대로 저장                          | 기본적으로 base64 인코딩 저장       |
| 보안        | 접근 제어가 없으므로 민감 데이터에 부적합 | RBAC 및 추가 암호화 설정 권장       |
| 사용 방식   | 환경변수, 파일, 명령줄 인자 등 다양       | 환경변수, 파일, 명령줄 인자 등 다양 |

두 리소스는 데이터의 성격에 따라 적절하게 선택해야 합니다. 민감하지 않은 설정 정보는 ConfigMap에, 민감한 정보는 Secret에 저장함으로써 보안 사고를 예방할 수 있습니다.

## 실제 운영에서의 베스트 프랙티스

- 분리 원칙: 애플리케이션 코드와 설정 정보를 분리하여 배포 시점에 환경에 맞게 조정할 수 있도록 합니다.
- 버전 관리: ConfigMap과 Secret을 버전 관리 시스템과 연동하여 변경 이력을 관리합니다.
- 보안 강화: Secret은 기본 인코딩 외에도 etcd 암호화, RBAC 정책을 적용해 접근을 엄격하게 통제합니다.
- 변경 감지: 설정 변경 시 애플리케이션이 자동으로 재로드되도록 하는 메커니즘(예: sidecar 패턴)을 고려합니다.
